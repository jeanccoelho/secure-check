#ifndef VULNERABILITYMANAGER_H
#define VULNERABILITYMANAGER_H

#include <QObject>
#include <QVector>
#include <QJsonDocument>
#include <QJsonObject>
#include <QJsonArray>
#include "VulnerabilityDefinition.h"

class VulnerabilityManager : public QObject
{
    Q_OBJECT

public:
    explicit VulnerabilityManager(QObject *parent = nullptr);
    
    bool loadDefinitions(const QString &filePath);
    QVector<VulnerabilityDefinition> getDefinitionsForOS(const QString &os) const;
    QStringList getSupportedOS() const;
    QString getCurrentOS() const;

private:
    QJsonDocument m_definitions;
    
    Severity stringToSeverity(const QString &severityStr) const;
    QString severityToString(Severity severity) const;
};

#endif // VULNERABILITYMANAGER_H